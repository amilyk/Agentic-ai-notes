# Task5学习笔记（高度自治智能体的模式）

> 本笔记是基于Datawhale开源课程[Agentic‑AI](https://github.com/datawhalechina/agentic-ai) 的@kangxun 个人学习笔记

---

### 实践总结

#### 1. 代码优先智能体案例

**实践场景**：LLM使用代码完成客户需求，并在安全环境下执行，实现客服智能体开发，模拟太阳镜商店的销售、退货、查询流程。</br>
**实践结论**：

+ 退货、购买会变更库存表，同时交易表会增加记录，变动余额，查询操作仅查询库存表，通过自然语言需求，能够调用LLM执行db操作，并实现智能客服操作。
+ reseed=True, 使得每次请求前重置库存表（商品数量初始化）、交易表（余额恢复初始化），便于测试单次请求。若想看到多次交易流程带来的库存、交易变更，可以设置reseed=False。
+ prompt描述为圆形太阳镜，而不是具体太阳镜名称，某些模型比如deepseek-chat会查询不到库存。

#### 2. 多智能体线性模式案例

**实践场景**：LLM线性模式，实现市场营销团队，对太阳镜产品的市场调研及营销文案图文的撰写。</br>
**实践结论**：

+ 制定一个复杂的开发任务，LLM能生成文案，再文生图，然后再生成slogan及理由，最后把图文整理成报告，多智能体协作可以快速给出方案，很让人惊奇。
+ 发现自己对多模态的API调用不熟悉，DeepLearning.ai官方可以使用openai，但本地实现的时候，转换成国内大模型或者开源大模型方案上还是花了大量时间，另外对每个模型适用场景不熟悉。文生图时候，替换成huggingface上stable-diffusion-xl-base-1.0，效果不如DALLE3，后续也可以改成Qwen3-VL根据文案生成图，而不是拆分2步。
+ 想用OpenAI作为统一接口，调用huggingface文生图模型还是没成功，最后用huggingface_hub去做的。

---

## 1.规划模式


### 1️⃣ 流程

为 LLM 提供一套 ​**工具集**​，让 LLM 能够 ​**根据任务写出计划**​，并 **制定调用工具的顺序** 来解决问题。

### 2️⃣ 痛点

* ​**计划不稳定**​：结果错误、越权（AI coding 为成功案例，其他领域较少）。
* ​**难点**​：工具与流程设计受开发者经验限制。

### 3️⃣ 规范LLM

* **结构化输出**：
  通过提示词要求 LLM 分步骤描述，并在每一步中指明所需的 工具 与 参数。
* **返回格式**​：JSON 列表，每个对象代表一个步骤，字段如下
  * `description` 步骤描述
  * `tool` 要调用的工具名称（如 `web_search`、`run_code` 等）
  * `arguments` 传递给工具的参数（键值对）


## 2.CodeAgent（代码优先规范计划）

1. ​**返回形式**​：规定 **以 Python 代码** 返回，并使用 \`\`\`\`\` 或 `<code>` 等标签进行分隔。
2. ​**安全执行**​：代码在 **安全沙箱** 中运行，隔离真实环境，降低风险。



## 3.多角色 Agent 协同开发

### 1️⃣ 多Agent优势

* ​**突破上下文限制**​：不需要单个 Agent 存储大量上下文，Agent 只查看其他 Agent 的结果进行总结。
* ​**成本与效率**​：多 Agent 分工合作，能够 ​**节约成本**​、提升 ​**时间效率**​。

### 2️⃣ 多Agent模式对比

| 模式                                           | 特点                                                                              | 适用场景                                 |
| ------------------------------------------------ | ----------------------------------------------------------------------------------- | ------------------------------------------ |
| ​**线性模式**​（固定流程任务）         | 顺序执行、单向通信；简单但不灵活。                                                | 流程明确、步骤固定的任务。               |
| ​**双层模式**​（多任务协调）           | Manager Agent 负责管理其他 Agent；任务协调性强、易控制，但管理负担重。            | 多子任务需要统一调度的情况。             |
| ​**多层模式**​（大型系统）             | 子 Agent 还有自己的下属 Agent（如作家 → 校对、风格写手）；模块化、通信复杂。     | 大型、层级分明的系统。                   |
| ​**去中心模式**​（探索型、生成型任务） | 每个 Agent 与其他 Agent 交流，直至所有 Agent 认为任务完成；创造性强、结果难预测。 | 创意生成、研究探索等需要高度协同的任务。 |

> ​**使用频率**​：线性模式和双层模式使用更频繁——层级越少，信息缺失越少，调度成本也更低。

